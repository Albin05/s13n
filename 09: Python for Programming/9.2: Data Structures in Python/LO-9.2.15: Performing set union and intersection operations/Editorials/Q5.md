### Q5: Course Enrollment System

**Solution:**

```python
n = int(input())
courses = {}

for _ in range(n):
    line = input().split(': ')
    course = line[0]
    students = set(line[1].split())
    courses[course] = students

while True:
    command = input().strip()

    if command == 'find_taking_multiple':
        # Find students in multiple courses
        student_courses = {}
        for course, students in courses.items():
            for student in students:
                if student not in student_courses:
                    student_courses[student] = []
                student_courses[student].append(course)

        print("Students taking multiple courses:")
        for student in sorted(student_courses.keys()):
            if len(student_courses[student]) > 1:
                course_list = ' '.join(sorted(student_courses[student]))
                print(f"- {student}: {len(student_courses[student])} courses ({course_list})")

    elif command == 'find_course_pairs':
        print("\nCourse pairs with shared students:")
        course_names = list(courses.keys())
        for i in range(len(course_names)):
            for j in range(i + 1, len(course_names)):
                shared = courses[course_names[i]] & courses[course_names[j]]
                if shared:
                    print(f"- {course_names[i]} & {course_names[j]}: {len(shared)} student{'s' if len(shared) > 1 else ''} ({' '.join(sorted(shared))})")

    elif command.startswith('recommend'):
        student = command.split()[1]

        # Find courses the student is taking
        student_courses = [c for c, students in courses.items() if student in students]

        # Find classmates
        classmates = set()
        for course in student_courses:
            classmates |= courses[course]
        classmates.discard(student)

        # Find courses classmates are taking
        recommendations = {}
        for classmate in classmates:
            for course, students in courses.items():
                if classmate in students and course not in student_courses:
                    recommendations[course] = recommendations.get(course, 0) + 1

        print(f"\nRecommendations for {student} (based on classmates):")
        for course in sorted(recommendations.keys(), key=lambda x: -recommendations[x]):
            print(f"- {course}: {recommendations[course]} classmates also take this")
        break
```

**Key Learning:** Complex analysis using union (`|`) for aggregation, intersection (`&`) for finding overlap, and set operations in loops for recommendations.

---

## Common Patterns

1. **Merge multiple sets:** `result = set1 | set2 | set3`
2. **Find common:** `common = set1 & set2 & set3`
3. **Exclusive to one:** `exclusive = set1 - set2 - set3`
4. **Union of list of sets:** `set.union(*list_of_sets)`
5. **Intersection of list of sets:** `set.intersection(*list_of_sets)`
